# Day 1:

---

# L1 Why do we need SPICE simulations?

## Overview

This lecture introduces the fundamental connection between circuit design and SPICE simulations in VLSI. Circuit design focuses on how logic gates such as inverters, NAND, NOR, AND, etc., are physically implemented using specific arrangements of PMOS and NMOS transistors. For example, in a CMOS inverter, the PMOS is connected at the top to VDD and the NMOS at the bottom to VSS, with their gates tied together and drains connected to form the output. This specific configuration gives the inverter its logic functionality. However, designing the connection alone is not sufficient; we must also understand how the circuit behaves electrically, which is where SPICE simulations become essential. SPICE characterizes transistor behavior by modeling NMOS and PMOS I-V characteristics and generating output waveforms. These waveforms determine delay, and delay depends directly on transistor sizing (W/L ratio), since W/L controls drive current, which shapes the output transition and ultimately defines cell timing.

<p align="center">
  <img src="https://github.com/user-attachments/assets/1bc14eb2-9c7f-46fe-9df8-06d16fb0c258" />
</p>


The lecture then explains why SPICE is critical in real VLSI flows such as physical design, clock tree synthesis (CTS), timing closure, and static timing analysis (STA). Although SPICE is not directly visible in these flows, all timing values used in STA originate from SPICE-based characterization. Standard cell libraries contain delay tables indexed by input slew and output load capacitance. For different buffer types (e.g., CBUF1 vs CBUF2), delay tables differ because their transistor sizes (W/L ratios) differ, giving them different drive strengths. When performing timing analysis, the tool selects a delay by interpolating between table entries based on the actual input slew and load capacitance. However, these delay values are not arbitrary; they are generated by detailed SPICE characterization of each cell under multiple conditions. Therefore, SPICE forms the foundation of all delay modelling.

## Example

In the example discussed, the instructor explains that different buffer types (such as CBUF1 and CBUF2) have different delay behaviours because they are designed with different transistor sizes (different W/L ratios), resulting in different drive strengths. The delay of a buffer is not a fixed value; instead, it depends on two main parameters: input slew and output load capacitance. Input slew refers to how fast the input signal transitions, and output load refers to the total capacitance the buffer must drive, including fanout and wiring capacitance. These two parameters form a delay table, where rows represent input slew values and columns represent output load values. The intersection gives the delay for that specific condition. If the exact load or slew is not available in the table, interpolation is used to estimate the delay. Even if two buffers receive the same input slew and drive the same load, their delays can differ because their internal transistor sizing differs. The instructor emphasizes that these delay values are not arbitrary; they come from SPICE characterization of each cell under different slew and load conditions. Thus, SPICE simulations are the foundation for generating the delay tables used in timing analysis, and they ensure that the delay values used in static timing analysis accurately reflect real transistor-level behaviour.

<p align="center">
<img width="708" height="366" alt="image" src="https://github.com/user-attachments/assets/b3b673f2-4e89-4319-9881-299c2bfaf6af" />
<img width="655" height="367" alt="image" src="https://github.com/user-attachments/assets/6381f3df-e82b-4b95-92cc-0a1285a12dc8" />
</p>

## Conclusion

The lecture raises three critical questions: (1) Where do delay tables come from? — They come from SPICE characterization of transistor-level circuits. (2) Are these delay models accurate? — Accuracy must be verified by comparing STA-extracted delays with direct SPICE simulation results under identical conditions. (3) How do we trust STA results? — By validating that the characterization data (derived from SPICE) accurately reflects real transistor behaviour. Ultimately, understanding NMOS and PMOS device physics, their voltage-current characteristics, and how W/L sizing affects delay is necessary to understand the origin of timing libraries and ensure correct chip functionality before tape-out. The lecture concludes by transitioning to a detailed study of NMOS transistor characteristics as the foundation for SPICE-based delay modelling. <br>

***


# L2 Introduction to basic element in Circuit design – NMOS

This lecture explains the fundamental structure of an NMOS transistor and builds the foundation for understanding threshold voltage and SPICE modeling. An NMOS is a four-terminal device consisting of gate, source, drain, and body (or bulk). It is built on a p-type substrate, and the source and drain are formed using heavily doped n+ diffusion regions. Above the substrate lies a thin gate oxide layer, and on top of the oxide is a polysilicon or metal gate. Isolation regions are also present to electrically separate adjacent transistors so that the operation of one device does not affect another. While the body terminal is often not explicitly shown in simplified circuit symbols because it is usually grounded, it plays a very important role in determining the threshold voltage. Any potential applied to the body can modify the threshold voltage, which directly affects device behavior.

<p align="center">
<img width="602" height="268" alt="image" src="https://github.com/user-attachments/assets/9737419d-99b7-4b90-9b57-6fa56ab35e66" /> </p>

The PMOS transistor has a similar structure but is complementary to the NMOS. It is built on an n-type substrate with p+ source and drain regions. Apart from the doping differences, the general structure remains the same. Understanding this structural difference is important for CMOS design.

##
The most critical parameter governing transistor operation is the threshold voltage (Vₜ). Threshold voltage determines when a conducting channel forms between source and drain. In SPICE simulations, transistor behavior is represented through mathematical models, and threshold voltage is a key component of these models. Although the full SPICE model contains complex equations, conceptually threshold voltage can be viewed as a function of several physical and electrical parameters. Accurate modeling of Vₜ ensures that SPICE simulations correctly represent real transistor behavior.

<p align="center">
<img width="677" height="257" alt="image" src="https://github.com/user-attachments/assets/cee5ef2e-fb4b-4312-92d4-139f2e76d419" /> </p>

To understand threshold voltage formation, consider the case when the gate-to-source voltage (VGS) is zero and all terminals are grounded. In this condition, the NMOS contains two back-to-back PN junctions: one between source and body and another between drain and body. Since no bias is applied, both junctions are effectively off, resulting in very high resistance between source and drain. No conducting channel exists, and therefore no current flows. The transistor is in the OFF state.

##

When a small positive voltage is applied to the gate, the gate, oxide, and substrate form a capacitor structure. The gate acts as one plate, the substrate acts as the other plate, and the oxide serves as the dielectric. Applying a positive voltage charges the gate positively. Because the substrate is p-type and contains holes as majority carriers, the positive gate voltage repels these holes away from the surface region beneath the gate. As holes move deeper into the substrate, they leave behind negatively charged ions. This creates a depletion region under the gate. At this stage, although charge redistribution has begun, a conducting channel has not yet formed.

<p align="center">
<img width="672" height="258" alt="image" src="https://github.com/user-attachments/assets/cb5fb083-3d40-4d8d-9720-d09797cf7102" /> </p>

If the gate voltage is increased further, the depletion region widens, and more holes are pushed away. Eventually, the electric field becomes strong enough to attract electrons (minority carriers in the p-type substrate) toward the surface. When sufficient electrons accumulate, an inversion layer forms beneath the gate oxide. This inversion layer creates a continuous conducting path between the n+ source and n+ drain regions. The gate voltage at which this conducting channel is formed is defined as the threshold voltage. Once VGS exceeds Vₜ, the transistor turns ON and current can flow between source and drain.

Understanding this physical process is essential because SPICE models are built upon these device physics principles. The threshold voltage, channel formation mechanism, and charge behavior directly influence I–V characteristics, delay, and overall transistor performance. Since all timing libraries and delay models used in digital design ultimately originate from SPICE-based characterization, a strong understanding of NMOS structure and threshold voltage formation is fundamental to accurate circuit design and timing analysis.

***

# L3: Strong Inversion and Threshold Voltage

## 1️. Initial Condition – VGS = 0 (Cutoff Region)

<p align="center">
  <img width="1292" height="488" alt="image" src="https://github.com/user-attachments/assets/311990e5-b4a9-4071-ade6-ed13e3b31c2e" />
</p>

When **VGS = 0** and drain, source, and bulk are connected to ground, the source–body and drain–body form two PN junction diodes. Since no bias is applied, both junctions are OFF.  

Therefore, the **source-to-drain resistance is very high**, and no current flows.  
The MOSFET operates in the **cutoff region**.

## 2️. Formation of Depletion Region

<p align="center">
  <img width="1282" height="481" alt="image" src="https://github.com/user-attachments/assets/ad2085f2-e233-4db5-ae60-4cf4c7466d30" />
</p>

When a small positive **VGS** is applied, the gate becomes positively charged.  
This repels holes (majority carriers in the p-substrate) away from the surface.  

As holes move deeper into the substrate, negative charge remains near the surface, forming a **depletion region**, similar to a reverse-biased PN junction diode.

## 3️. Increasing Gate Voltage – Surface Inversion Begins

<p align="center">
 <img width="830" height="483" alt="image" src="https://github.com/user-attachments/assets/920012a3-1082-41f8-a5da-f3de455427dc" />
</p>

As **VGS** increases further, the depletion region widens.  

Eventually, the electric field becomes strong enough to attract electrons (minority carriers) toward the surface.  
The semiconductor surface begins to behave like **n-type material**.

## 4️. Strong Inversion and Threshold Voltage (Vₜ)

<p align="center">
  <img width="1281" height="482" alt="image" src="https://github.com/user-attachments/assets/ba7f0a44-4e81-4218-9a80-5adafa64dae2" />
</p>

When the surface is fully inverted and a thin n-type layer forms beneath the gate oxide, the device reaches **strong inversion**.  

The gate voltage at which strong inversion occurs is defined as the:

> ### **Threshold Voltage (Vₜ)**

This voltage determines when the MOSFET turns ON and forms the foundation of SPICE modeling.

## 5️. Increasing VGS Beyond Threshold

<p align="center">
  <img width="1281" height="471" alt="image" src="https://github.com/user-attachments/assets/a7cba5be-0e80-45c0-bc50-1cf6649a08d4" />
</p>

After threshold is reached:

- The depletion width does **not increase significantly**
- The region is already depleted of majority carriers
- Additional gate voltage increases **inversion charge density**

## 6️. Electron Attraction from n+ Source

<p align="center">
  <img width="598" height="470" alt="image" src="https://github.com/user-attachments/assets/4fc44052-0988-4904-93b7-ad0df55ad515" />
</p>

When VGS increases beyond Vₜ, electrons are drawn from the heavily doped **n+ source region** into the area under the gate.  

This strengthens the inversion layer and increases channel charge.

## 7️. Continuous n-Channel Formation

<p align="center">
 <img width="1297" height="605" alt="image" src="https://github.com/user-attachments/assets/92d4c137-1887-44f1-a4bd-afc199624af8" />
</p>

Once sufficient electrons accumulate, a **continuous n-type channel** forms between source and drain.  

The conductivity of this channel is controlled by **VGS**.  

Current will flow only when a drain voltage is applied.

## 8️. Case 1: VSB = 0

<p align="center">
  <img width="536" height="477" alt="image" src="https://github.com/user-attachments/assets/269a4ba3-0b9c-44c6-8493-1604815f415f" />
</p>

When source and body are at the same potential:

- No additional reverse bias exists
- Depletion width is normal
- Threshold voltage is at nominal value

## Case 2: VSB > 0

<p align="center">
 <img width="647" height="453" alt="image" src="https://github.com/user-attachments/assets/a2dcf7a2-fc18-4d3c-ae0b-76f94e3353a9" />
</p>

When a positive voltage is applied between source and body:

- The source–body PN junction becomes more reverse biased
- Depletion region width increases near the source

## 9. Additional Reverse Bias Effect

<p align="center">
  <img width="1175" height="542" alt="image" src="https://github.com/user-attachments/assets/dd2a5b07-beef-4a4e-afa0-20d30efb2eb0" />
</p>

The additional reverse bias makes inversion harder to achieve because:

- A larger depletion region must be overcome
- More gate voltage is required


## 10. Depletion Width Increases Near Source

<p align="center">
 <img width="1212" height="582" alt="image" src="https://github.com/user-attachments/assets/098eff6e-9fdb-4bb6-952d-2e4db412f7a3" />
</p>

The depletion layer near the source becomes slightly larger compared to the VSB = 0 case.  

Therefore, inversion is delayed.

***

# L4: Threshold Voltage in Presence of Body Bias (VSB ≠ 0)

## 1️. Comparing Two Cases: VSB = 0 and VSB > 0

<p align="center">
  <img width="680" height="321" alt="image" src="https://github.com/user-attachments/assets/569f37d4-d52a-45a0-892c-71f21319728c" />
</p>

We consider two scenarios:

- Case 1: VSB = 0  
- Case 2: VSB > 0  

In both cases, the gate-to-source voltage (VGS) is increased gradually.  
The depletion width increases in both scenarios.  

However, a key difference appears when VSB is positive.


## 2️. Effect of Positive VSB on Charge Distribution

<p align="center">
 <img width="613" height="262" alt="image" src="https://github.com/user-attachments/assets/ed4638e0-6360-414a-8a8b-82b4b9ee0dd8" />
</p>

When VSB is positive, the source is at a higher potential relative to the body.  
This creates additional reverse bias across the source–body PN junction.

As negative charges accumulate under the gate due to increasing VGS,  
the positive source terminal attracts some of these charges toward itself.

In the VSB = 0 case, charges simply accumulate under the gate region.

This causes inversion to be delayed when VSB > 0.


## 3️. Surface Inversion Comparison

<p align="center">
  <img width="627" height="257" alt="image" src="https://github.com/user-attachments/assets/449ad035-648f-416d-a07e-a0a974fe297e" />
</p>

As VGS increases:

- Inversion occurs earlier when VSB = 0  
- Inversion is delayed when VSB > 0  

At the same VGS value, the device without body bias may already show strong inversion,  
while the device with positive VSB has not yet fully inverted.


## 4️. Definition of VTO (Threshold Voltage at VSB = 0)

<p align="center">
  <img width="647" height="317" alt="image" src="https://github.com/user-attachments/assets/343099b0-b525-4660-9fa8-cca860d2b8ac" />
</p>

**VTO** is defined as the threshold voltage when VSB = 0.

At:

- VGS = VTO → Strong inversion occurs when VSB = 0  
- The same VGS does not produce inversion when VSB > 0
- 

## 5️. Additional Gate Voltage Required (VTO + V1)

<p align="center">
<img width="680" height="316" alt="image" src="https://github.com/user-attachments/assets/cdda03c0-90f7-4f45-b576-6f0fd469d4a1" />
</p>

When VSB is positive, additional gate voltage is required to achieve inversion.

If:

- VGS = VTO → inversion only when VSB = 0  
- VGS = VTO + V1 → inversion when VSB > 0  

An extra voltage **V1** is required due to body bias.


## 6️. Conclusion: 

<p align="center">
  <img width="680" height="364" alt="image" src="https://github.com/user-attachments/assets/3149b3e0-bc04-4dfb-9794-8ec8f973b1db" />
</p>

In the presence of substrate bias VSB:

- Strong inversion requires additional gate voltage  
- Threshold voltage increases  


## 7️. Threshold Voltage Equation

<p align="center">
  <img width="678" height="302" alt="image" src="https://github.com/user-attachments/assets/563a39cd-6dd7-4601-9871-d919c2db2767" />
</p>
- Vto = Threshold voltage at Vsb = 0, and is a function of manufacturing process.


## 8. Body Effect Coefficient (γ)

<p align="center">
  <img width="222" height="117" alt="image" src="https://github.com/user-attachments/assets/8eae9769-4617-4d54-bc37-7f1b6b0a9dd3" />
      </p>

γ (Gamma) is called the **Body Effect Coefficient**.

It represents how strongly VSB influences the threshold voltage.

Gamma depends on:

- Substrate doping concentration (NA)  
- Oxide capacitance (Cox)  
- Relative permittivity of Si = 11.7
- Electron charge (q)   

These parameters are technology-dependent and provided by the foundry.


## 9. Fermi Potential (ΦF)

<p align="center">
  <img width="270" height="76" alt="image" src="https://github.com/user-attachments/assets/f0fa453f-9270-48ee-86ba-a3c1f31e56db" />
</p>

The Fermi potential (ΦF) appears in the threshold voltage equation.

---

# L5: Resistive (Linear) Region of Operation


## 1️. Three Modes of Operation

<p align="center">
 <img width="652" height="247" alt="image" src="https://github.com/user-attachments/assets/61555aa1-95e0-4e67-8621-2d1d447da8ec" />
</p>

The MOSFET operates in three regions:

- Cutoff region  
- Resistive (Linear) region  
- Saturation region  

Previous discussions focused on the cutoff region, where strong inversion occurs at VGS = VT.  
This section begins the discussion of the resistive (linear) region.


## 2️. Threshold Voltage Recap

<p align="center">
<img width="670" height="261" alt="image" src="https://github.com/user-attachments/assets/c98efddf-f63f-4f7a-810e-c126b0e9ea4a" />
</p>

At VGS = VT, strong inversion occurs and the semiconductor surface becomes n-type.  

When VGS > VT:

- More charge carriers are induced  
- Channel width increases  
- Conducting path between source and drain strengthens  


## 3️. Effective Channel Length

<p align="center">
  <img width="403" height="321" alt="image" src="https://github.com/user-attachments/assets/005be098-892a-45b3-819b-0030fd7e0eb1" />
</p>

Due to fabrication techniques, the effective channel length is smaller than the designed channel length.

For example:

- Designed channel length may be 100 nm  
- Effective channel length may be smaller  

For simplicity in this discussion, the effective channel length is assumed to be L.


## 4️. Channel Representation Along x-Axis

<p align="center">
  <img width="662" height="303" alt="image" src="https://github.com/user-attachments/assets/04f4f7b6-e02c-4daa-affd-85f79036641f" />
</p>

The channel is represented from:

- x = 0 (source)  
- x = L (drain)  

At every point along the channel, the voltage can be different once VDS is applied.


## 5️. Induced Charge and Gate Voltage Relationship

As VGS increases:

- Channel width increases  
- Induced charge increases  
- Conducting region expands  

The induced charge in the channel is proportional to:

VGS − VT  

Only the portion of VGS greater than VT contributes to channel formation.


## 6️. Applying Small Drain-to-Source Voltage (VDS)

<p align="center">
  <img width="422" height="318" alt="image" src="https://github.com/user-attachments/assets/917eefc4-388d-4853-b1e1-a1cc607a4fba" />
</p>

Now a small drain-to-source voltage is applied.

Example values used:

- VGS = 1 V  
- VDS = 0.05 V (50 mV)  

VDS is kept very small initially.  
Higher VDS cases will be discussed later.


## 7️. Voltage is No Longer Constant Across the Channel

<p align="center">
  <img width="422" height="318" alt="image" src="https://github.com/user-attachments/assets/4c697de7-1a51-4dc5-9620-610d6baedc49" />
</p>

In the absence of VDS, the channel voltage is constant.

Once VDS is applied:

- A voltage gradient appears  
- Voltage varies along the channel  

At different positions:

- At source end → V(x) ≈ 0  
- At drain end → V(x) ≈ VDS  
- Intermediate points → Voltage lies between 0 and VDS  

This is an important observation.


## 8️. Gate-to-Channel Voltage Variation

<p align="center">
  <img width="421" height="330" alt="image" src="https://github.com/user-attachments/assets/534aca29-ebf4-463f-a657-c79f11b67d24" />
</p>

With VDS applied, the effective gate-to-channel voltage at any point x becomes:

VGS − V(x)

Because:

- V(x) = 0 at source  
- V(x) = VDS at drain  
- V(x) varies continuously along channel  

Therefore, channel charge varies along the channel length.


## 9️. Condition on VDS

Two different behaviors are mentioned:

- When VDS < VGS − VT  
- When VDS > VGS − VT  

These two cases behave differently and will be discussed later.

For now, VDS is assumed to be small.


## 10. Transition to Drain Current Derivation

Because V(x) varies across the channel:

- Induced charge varies  
- Current will vary along the channel  

The drain current equation will be derived next.

The drain current equation:

- Drives transistor behavior  
- Determines delay  
- Is used in simulations and circuit design  

The derivation in the resistive region will continue in the next discussion.

---

# L2: Drift Current Theory


## 1️. Definition of V(x) Along the Channel

<p align="center">
  <img width="682" height="318" alt="image" src="https://github.com/user-attachments/assets/4908d633-8758-4df2-b903-d993cca1da8d" />
</p>

In the previous discussion, the term **V(x)** was introduced.

V(x) represents the voltage at each point along the channel (x-axis).

- At x = 0 → V(0) = 0 V  
- At x = L → V(L) = VDS  

Thus, voltage varies from source to drain.


## 2️. Effective Channel Voltage (VGS − V(x))

Because VGS is applied at the gate, the effective channel voltage at any point becomes:

### **VGS − V(x)**

Example:

If:
- VGS = 1 V  
- V(0) = 0 V  

Effective voltage at source = 1 − 0 = 1 V  

If:
- VGS = 1 V  
- V(L) = VDS = 0.05 V  

Effective voltage at drain = 1 − 0.05 = 0.95 V  

So the channel voltage lies between **1 V and 0.95 V**.


## 3️. Voltage Gradient Across the Channel

Because V(x) changes from 0 to VDS:

- Channel voltage is not constant  
- A voltage gradient exists  

If VDS were grounded, the channel voltage would be constant.  
With VDS applied, it gradually decreases from source to drain.


## 4️. Induced Charge in Presence of VDS

<p align="center">
  <img width="672" height="323" alt="image" src="https://github.com/user-attachments/assets/a7f82b30-55e3-4d94-afb3-0cbf46e7a97f" />
</p>

The induced charge at each point depends on:

### **VGS − V(x) − VT**

Since VT is the threshold voltage that turns on the transistor, it must be subtracted.

Thus, induced charge varies along the channel.


## 5️. Charge Equation (Q = C × V)

<p align="center">
  <img width="673" height="317" alt="image" src="https://github.com/user-attachments/assets/f0297e8d-82e5-4add-be53-e8246784379d" />
</p>

Using the charge relation:

### **Q = C × V**

The induced charge at each point becomes:

### **Q(x) = Cox (VGS − V(x) − VT)**

Where:

Cox = Gate oxide capacitance  
Cox = εox / tox  

These are constants for a given technology.


## 6️. Oxide Capacitance Parameters

<p align="center">
  <img width="661" height="318" alt="image" src="https://github.com/user-attachments/assets/2c3fbed5-59f4-43e4-9ba2-d3c7dd294a3d" />
</p>

Cox depends on:

- εox (oxide permittivity)  
- tox (oxide thickness)  

εox = 3.97 × ε₀  
tox = Gate oxide thickness  

The oxide lies between:

- Gate  
- p-type substrate  

These are technology constants from the foundry.


## 7. Two Types of Currents in Device Physics

<p align="center">
  <img width="675" height="316" alt="image" src="https://github.com/user-attachments/assets/4af8ca1c-3801-4fca-bd2b-028e81419fb2" />
</p>

Two types of currents exist:

### (a) Drift Current  
Current due to potential difference between two points.

### (b) Diffusion Current  
Current due to difference in carrier concentration.

Analogy used:

- One tank filled with water  
- One tank empty  
- Water flows due to difference in water levels  

Similarly, diffusion current flows due to difference in carrier concentration.


## 8. Current Considered in This Discussion

<p align="center">
  <img width="647" height="318" alt="image" src="https://github.com/user-attachments/assets/0c0773bd-7e66-4247-a590-1baa1087b833" />
</p>

This discussion focuses on **drift current**.

Because:

- Source = 0 V  
- Drain = VDS  

There is a potential difference.

Therefore, current flowing from source to drain is drift current.

Diffusion current related to PN junction behavior will be discussed separately.


## 9. Definition of Drift Current

<p align="center">
  <img width="682" height="317" alt="image" src="https://github.com/user-attachments/assets/672f1957-6c27-4fdd-9964-aa4aaae28667" />
</p>

Drift current is defined as:

### **Velocity of charge carriers × Available charge**

This happens over a certain area — the channel width.


## 10. Channel Width (Top View Perspective)

<p align="center">
  <img width="646" height="367" alt="image" src="https://github.com/user-attachments/assets/03e3bd33-e946-4ab5-8cab-1973bc5acc3f" />
</p>

From the side view, only channel length is visible.

From the top view:

- Gate appears rectangular  
- Source and drain are visible  
- Channel lies between them  
- Gate overlaps source and drain  

Current flows across the complete channel width.


## 11. Current as Function of Area

Current depends on:

- Carrier velocity  
- Available charge  
- Channel width  

To derive the drain current equation:

- Substitute velocity expression  
- Substitute charge expression  
- Integrate across the channel  

---

# L3 Drain current model for linear region of operation


## 1️. Objective of Derivation

<p align="center">
  <img width="235" height="293" alt="image" src="https://github.com/user-attachments/assets/9f758ec3-e3d5-4422-be32-65a4235dc9d3" />
</p>

Previously, drain current was identified as:

**Drain Current = Velocity of charge carriers × Available charge × Channel width**

Now the goal is to derive a mathematical model for I<sub>D</sub> that can be used by an engine.

SPICE already has complicated and accurate models.  
Here, we derive a simple working model to understand the basics behind SPICE simulations.


## 2️. Drain Current Expression Setup

Drain current is expressed as:

- Velocity → v<sub>n</sub>(x)  
- Induced charge → q<sub>i</sub>(x)

So,

I<sub>D</sub> = v<sub>n</sub>(x) × q<sub>i</sub>(x) × W

Where:
- W = channel width


## 3️. Velocity Expression

Velocity is defined as:

v<sub>n</sub>(x) = μ<sub>n</sub> (dV/dx)

Where:
- μ<sub>n</sub> = mobility  
- dV/dx = electric field  

Since there is a voltage gradient along the channel, velocity is proportional to the electric field.


## 4️. Induced Charge Expression

<p align="center">
  <img width="225" height="292" alt="image" src="https://github.com/user-attachments/assets/9e655fe6-9483-4699-8f4f-40bad2b1a8dd" />
</p>

Previously derived:

q<sub>i</sub>(x) = C<sub>ox</sub> (V<sub>GS</sub> − V(x) − V<sub>T</sub>)

Where:

C<sub>ox</sub> = ε<sub>ox</sub> / t<sub>ox</sub>

These are technology constants.


## 5️. Substitution into Drain Current

<p align="center">
  <img width="242" height="357" alt="image" src="https://github.com/user-attachments/assets/f5b0a66a-f964-4954-8e9d-bbf9e79f1879" />
</p>

Substitute:

v<sub>n</sub>(x) = μ<sub>n</sub> (dV/dx)

q<sub>i</sub>(x) = C<sub>ox</sub> (V<sub>GS</sub> − V(x) − V<sub>T</sub>)

Multiply by W and integrate across the channel length.


## 6️. Integration Limits

Integration conditions:

- dx from 0 to L  
- dV from 0 to V<sub>DS</sub>  

Voltage varies from source to drain.


## 7️. Result After Integration

<p align="center">
<img width="242" height="263" alt="image" src="https://github.com/user-attachments/assets/f952a453-bf69-41a7-a168-fbc71aed3797" />
</p>

After integration:

I<sub>D</sub> = μ<sub>n</sub> C<sub>ox</sub> (W/L)  
[(V<sub>GS</sub> − V<sub>T</sub>) V<sub>DS</sub> − V<sub>DS</sub><sup>2</sup> / 2]

Where:

- μ<sub>n</sub>  
- C<sub>ox</sub>  
- W  
- L  

are technology constants.

These form part of the model parameters in SPICE.


## 8️. Process Transconductance Parameter

<p align="center">
<img width="248" height="340" alt="image" src="https://github.com/user-attachments/assets/ce21fe61-aab8-4886-93d2-fec73dc4b5fe" />
</p>

Define:

k'<sub>n</sub> = μ<sub>n</sub> C<sub>ox</sub>

This is the process transconductance parameter.

Then define:

k<sub>n</sub> = k'<sub>n</sub> (W/L)

This is called the gain factor.

The drain current becomes:

I<sub>D</sub> = k<sub>n</sub>  
[(V<sub>GS</sub> − V<sub>T</sub>) V<sub>DS</sub> − V<sub>DS</sub><sup>2</sup> / 2]



## 9️. Observation: Quadratic Term in VDS

The equation contains:

V<sub>DS</sub><sup>2</sup> / 2

So I<sub>D</sub> is quadratic in V<sub>DS</sub>.

But this applies when V<sub>DS</sub> is small.


## 10. Numerical Example

<p align="center">
  <img width="645" height="361" alt="image" src="https://github.com/user-attachments/assets/a6238142-c831-405c-a324-7964268ad63d" />
</p>

Given:

- V<sub>GS</sub> = 1 V  
- V<sub>T</sub> = 0.45 V  
- V<sub>DS</sub> = 0.05 V  

Compute:

(V<sub>GS</sub> − V<sub>T</sub>) = 0.55  

(V<sub>GS</sub> − V<sub>T</sub>) V<sub>DS</sub> = 0.0275  

V<sub>DS</sub><sup>2</sup> / 2 = 0.00125  

The second term is very small compared to the first.


## 11. Linear Region Condition

For:

V<sub>DS</sub> < (V<sub>GS</sub> − V<sub>T</sub>)

The term:

V<sub>DS</sub><sup>2</sup> / 2

can be neglected.

Then:

I<sub>D</sub> ≈ k<sub>n</sub> (V<sub>GS</sub> − V<sub>T</sub>) V<sub>DS</sub>

Now I<sub>D</sub> becomes linear in V<sub>DS</sub>.

This defines the **linear (resistive) region of operation**.


## 1️2. Final Linear Region Model

<p align="center">
 <img width="666" height="363" alt="image" src="https://github.com/user-attachments/assets/087dfb7f-4de5-470f-b19c-f726fc6f8d3a" />
</p>

For:

V<sub>DS</sub> < (V<sub>GS</sub> − V<sub>T</sub>)

The drain current model is:

I<sub>D</sub> = k<sub>n</sub> (V<sub>GS</sub> − V<sub>T</sub>) V<sub>DS</sub>

---

# L5: Pinch-Off Region Condition


## 1. Sweeping VDS

<p align="center">
<img width="1112" height="607" alt="image" src="https://github.com/user-attachments/assets/133c40e1-d2b5-480b-b374-f3e969f30c52" />
</p>

Now:

- VGS is kept constant at 1 V  
- VT is kept constant at 0.45 V  
- VDS is increased from 0.05 V to 0.95 V  
  in steps of 0.1 V  

This sweep could be fed directly into a SPICE engine.

But before simulations, the physical concept must be understood.


## 2. Linear Region Behavior 

<p align="center">
<img width="1260" height="620" alt="image" src="https://github.com/user-attachments/assets/64c1c298-daa4-40b2-b2fe-71e815a2a946" />
</p>

As VDS increases from:

0.05 → 0.45 V

The channel voltage:

VGS − VDS

takes values:

- 0.95 V  
- 0.85 V  
- 0.75 V  
- 0.65 V  
- 0.55 V  

All of these are greater than VT (0.45 V).

Therefore:

- Channel exists
- Surface inversion is maintained
- Device operates in linear region


## 3. Critical Condition: VDS = 0.55 V

<p align="center">
<img width="1208" height="591" alt="image" src="https://github.com/user-attachments/assets/24237e50-417c-4fd8-a066-5f7fa152b518" />
</p>

When:

VDS = 0.55 V

<p align="center">
<img width="1220" height="577" alt="image" src="https://github.com/user-attachments/assets/dbbce28d-601e-436e-8523-502719c01df4" /> </p>

Channel voltage becomes:

VGS − VDS = 1 − 0.55 = 0.45 V

Now:

Channel Voltage = VT

At this exact point:

- Surface inversion just happens at the drain end
- One end of channel is at threshold
- Other end (near source) is still greater than threshold

This creates a mixed condition:

- Near source → inversion already exists  
- Near drain → inversion just disappears  


## 4. Beginning of Channel Disappearance

<p align="center">
<img width="1230" height="586" alt="image" src="https://github.com/user-attachments/assets/4548c733-ce9c-495c-b059-86cba4e6427b" />
</p>

Since channel voltage no longer satisfies:

VGS − VDS > VT

The channel begins to disappear near the drain region.

The channel still exists near the source.


## 5. Does Current Stop?

No.

Even though the channel begins to disappear near the drain:

- There is still potential difference between source and drain
- Current still flows

However:

- The linearity of current changes
- Behavior transitions from linear region


## 6. When VDS Increases Further

<p align="center">
<img width="656" height="308" alt="image" src="https://github.com/user-attachments/assets/bc86950b-baca-4d95-843c-a0d2cdafeaa2" />
</p>

If VDS increases further:

0.65 V  
0.75 V  
0.85 V  
0.95 V  

Then:

VGS − VDS < VT

In this condition:

- No channel near drain
- Channel exists only near source
- Drain-end channel completely disappears


## 7. Saturation Region Condition

This condition is referred to as:

**Saturation Region**

Pinch-off occurs when:

VGS − VDS ≤ VT

This means:

The device enters saturation region.

From this point onward:

- Channel near drain vanishes
- Device behavior changes

---

# L6 Drain current model for saturation region of operation


## 1️. When VDS Increases Beyond Limit

When VDS is increased to such an extent that:

VGS − VDS < VT

the channel begins to disappear near the drain.

This creates a contradiction compared to the linear region.


## 2️. Contradiction Between Linear and Pinch-Off Region

In the linear region:

Channel voltage = VGS − VDS  
and the transistor operates normally.

But when:

VGS − VDS < VT

the channel is no longer valid near the drain.

Only a small channel beneath the gate near the source remains.


## 3️. Channel Voltage Behavior in Saturation

<p align="center">
  <img width="663" height="331" alt="image" src="https://github.com/user-attachments/assets/85f4fa66-8be9-4c45-be5d-0537ec93f0c4" />
</p>

In the saturation region:

Channel voltage remains approximately constant.

It becomes:

VGS − VT

It is no longer dependent on VDS the way it was in the linear region.

This is the important difference between linear and saturation region.


## 4. Revisiting Linear Region Equation

Previously derived linear region equation:

I<sub>D</sub> = k<sub>n</sub> (VGS − VT) VDS − (k<sub>n</sub> / 2) VDS²

For small VDS:

The VDS² term was neglected.

This made drain current linear in VDS.


## 5. Replacing Channel Voltage in Saturation

<p align="center">
<img width="681" height="342" alt="image" src="https://github.com/user-attachments/assets/28e5eb63-1db7-49e7-898f-bfe3441bfffe" /> </p>

In saturation:

Channel voltage becomes constant:

VGS − VT

So in the drain current equation:

VDS is replaced by VGS − VT

Because:

Channel voltage = Drain-to-source voltage  
And in saturation, it is fixed at VGS − VT


## 6. Saturation Drain Current Equation

<p align="center">
<img width="151" height="42" alt="image" src="https://github.com/user-attachments/assets/90b8f1bd-9bd1-4101-919c-aeecf3a2e527" /> </p>

After substitution:

I<sub>D</sub> = (k<sub>n</sub> / 2) (VGS − VT)²

This is the drain current equation in the saturation region.

It is no longer a linear function of VDS.


## 7. Constant Current Behavior

<p align="center">
  <img width="622" height="251" alt="image" src="https://github.com/user-attachments/assets/b3d1b5dd-e5be-4dce-a547-60529d8b47c8" />
    </p>
  
If:

- VT is constant  
- VGS is constant  

Then:

I<sub>D</sub> becomes constant.

As VDS increases further beyond pinch-off:

Drain current remains approximately constant.

This makes the MOSFET appear like a constant current source in saturation.


## 8. Revisiting k<sub>n</sub> Expression

k<sub>n</sub> = k'<sub>n</sub> (W / L)

From this equation:

It appears that reducing channel length L increases drain current.

However, this is not always true.


## 9. Effective Channel Length Modulation

<p align="center">
  <img width="655" height="337" alt="image" src="https://github.com/user-attachments/assets/2bd99e07-9de6-4dc6-b48f-700b5b780e65" />
</p>

Although channel voltage becomes constant:

The effective channel length is still modulated by VDS.

As VDS increases further:

- Effective channel length reduces  
- Depletion region at drain increases 

There exists a channel length modulation factor that can be added to the equation for completeness.

---

# L1: Basic SPICE Setup

## 1️. Feeding Models to SPICE Engine


<p align="center">
<img width="631" height="292" alt="image" src="https://github.com/user-attachments/assets/a0b62562-29c1-4512-8a94-dd146128542e" /> </p>


Now the next part is to feed the derived models correctly into the SPICE engine so that it understands them and evaluates the drain current equations as expected.

Previously, we worked with:

- The MOSFET structure  
- Applied VDS  
- Applied VGS  
- Grounded source and substrate  

We also derived model equations:

- Threshold voltage equation  
- Linear region drain current equation  
- Saturation region drain current equation  

These represent the MOSFET behavior.

Some of these equations are more complex and will be studied later in semiconductor device physics lectures.

For now, these are the models that represent the MOSFET.


## 2️. Linear Region Model Review

<p align="center">
<img width="167" height="60" alt="image" src="https://github.com/user-attachments/assets/ec39eb2b-5fff-4ee8-9865-f5284e442e92" /> </p>

In hand calculations, we ignored the term:

VDS² / 2

because VDS was assumed small.

That allowed us to approximate drain current as a linear function of VDS.

However, in SPICE:

We do not ignore terms manually.

The engine handles full expressions for better accuracy.


## 3️. Saturation Region Model Review

<p align="center">
<img width="206" height="61" alt="image" src="https://github.com/user-attachments/assets/ce48dffd-5daa-4d4d-982b-c1804fae6590" /> </p>

In saturation:

Channel voltage becomes:

VGS − VT

Replacing VDS in the equation gives:

I<sub>D</sub> = (k<sub>n</sub> / 2) (VGS − VT)²

This is the saturation region current equation.

This equation is no longer linear in VDS.


## 4️. Technology Constants (Model Parameters)

<p align="center">
<img width="462" height="278" alt="image" src="https://github.com/user-attachments/assets/5f70f1dc-b838-4068-8cb5-c90f1789e902" /> </p>

Certain parameters are technology constants, for example:

- μn  
- Cox  
- k'n  
- k<sub>n</sub>  
- VT  
- γ  
- φf  

These constants come from the foundry for each technology node.

Examples:

- 1.2 micron  
- 180 nanometers  
- 20 nanometers  

Each node has unique values.

These values are provided to SPICE through a special file called:

**Model File**

We do not derive these again.

They are supplied as constants.

Correct model parameters are essential to obtain correct voltage and current waveforms.


## 5️. SPICE Inputs Required

Two main inputs are required:

1. SPICE Model Parameters (Technology constants)  
2. SPICE Netlist  

Both must be provided correctly to the SPICE engine.


## 6️. SPICE Output

<p align="center">
<img width="131" height="247" alt="image" src="https://github.com/user-attachments/assets/09c12adb-5648-4ce7-bb1f-d026309b0652" />
 </p>

When both:

- Model file  
- Netlist  

are fed into SPICE,

We obtain:

- IDS vs VDS curves  
- Different curves for different VGS values  

Previously, we observed behavior where part of curve was linear and part entered saturation.

SPICE reproduces these curves automatically.


## 7️. Netlist 

<p align="center">
<img width="592" height="296" alt="image" src="https://github.com/user-attachments/assets/a59dcde1-8517-4102-ab49-06df419838b8" /> </p>

SPICE requires a special syntax (like C or C++ program syntax).

The MOSFET cannot be given directly as a diagram.

It must be written in a special formatted netlist.

This formatted description is called a:

**SPICE Deck**


## 8️. MOSFET Circuit Setup

<p align="center">
<img width="268" height="186" alt="image" src="https://github.com/user-attachments/assets/19dfb3f4-643b-4b74-82ec-5f2eb374905d" /> </p>

Circuit connections:

- Drain connected to VDD  
- Source connected to ground  
- Substrate connected to ground  
- Gate connected through a protection resistor  

The protection resistor is used because:

Current should not directly enter the gate and damage it.

---

# L2: Circuit Description in SPICE Syntax

## Writing the SPICE Netlist

<p align="center">
<img width="612" height="298" alt="image" src="https://github.com/user-attachments/assets/d1d151fb-2c42-463c-b04f-504e2b920c7e" /> </p>

Now that we understand the basic SPICE setup, the next step is to write the SPICE netlist in the correct syntax so that it is properly understood by the SPICE engine.

Just like a C program or any software language has its own syntax, SPICE also has its own syntactical format.

We now write the SPICE netlist for this circuit and simulate it.


## Assigning Circuit Values

<p align="center">
<img width="282" height="157" alt="image" src="https://github.com/user-attachments/assets/84b52116-dfc6-44b3-98aa-d3d6a31a1205" /> </p>

Before defining nodes, assign values:

- VDD = 2.5V  
- R1 = 55 ohms  
- MOSFET M1:
  - Width (W) = 1.8 micron  
  - Length (L) = 1.2 micron  

VSS = 0V

This must now be written in a SPICE-understandable format.


## Step 1: Defining Nodes

<p align="center"> <img width="293" height="176" alt="image" src="https://github.com/user-attachments/assets/4d650baf-db72-47dd-bbac-9abf13807311" />
</p>

A component must be defined between nodes.

A node is formed where there is no electrical obstruction along a connected wire.

For example:

- Continuous wire from R1 to voltage source → one node  
- Continuous wire from supply to ground → one node  
- Continuous wire from transistor terminal to supply → one node  

The circuit contains four nodes.

<p align="center">
  <img width="597" height="256" alt="image" src="https://github.com/user-attachments/assets/2c60183c-db18-4682-8286-f82f0e68cc87" />
</p>

We assign names:

- in  
- n1  
- 0  
- VDD  

There is no restriction on node names. They can be numeric or text.


## Step 2: Writing MOSFET Entry

<p align="center">
<img width="611" height="178" alt="image" src="https://github.com/user-attachments/assets/e85124f1-41ce-42ef-9c08-25b3979b96db" /> </p>

MOSFET has four terminals:

Drain, Gate, Source, Substrate.

SPICE expects the order:

Drain Gate Source Substrate (DGSS)

Syntax format:

Mname Drain Gate Source Substrate ModelName W= L=

For this circuit:

M1 vdd n1 0 0 NMOS W=1.8u L=1.2u

Explanation:

- M1 → first MOSFET  
- vdd → Drain node  
- n1 → Gate node  
- 0 → Source node  
- 0 → Substrate node  
- NMOS → model name (comes from technology file)  
- W and L → width and length  

The name "NMOS" comes from the technology file, which defines device parameters.

We start with a long channel length (1.2 micron) intentionally to later compare with short-channel behavior.


## Step 3: Writing Resistor Entry

<p align="center">
<img width="606" height="186" alt="image" src="https://github.com/user-attachments/assets/f8ffc04a-1cc4-4b56-b60d-49dc03d28967" /> </p>


Resistors start with R.

Syntax:

Rname Node1 Node2 Value

For this circuit:

R1 in n1 55

This defines:

- R1 between node "in" and node "n1"  
- Value = 55 ohms  


## Step 4: Writing VDD Supply

<p align="center">
<img width="640" height="210" alt="image" src="https://github.com/user-attachments/assets/a00465ed-e016-48ad-9f34-380b455a4352" /> </p>

Voltage sources start with V.

Syntax:

Vname PositiveNode NegativeNode Value

For VDD:

VDD VDD 0 2.5

- Between node VDD and ground  
- Value = 2.5V  


## Step 5: Writing Gate Voltage Source

<p align="center">
<img width="617" height="203" alt="image" src="https://github.com/user-attachments/assets/26d0cab3-6674-4db5-9228-2772c301cf3b" /> </p>

Gate voltage source:

VIN in 0 2.5

- Between node "in" and ground  
- Value = 2.5V  

Any element starting with V represents a voltage source.


## Complete SPICE Netlist

<p align="center">
<img width="262" height="68" alt="image" src="https://github.com/user-attachments/assets/18675667-e02c-4a30-9ec7-d799037171d9" /> </p>

```spice
M1 VDD n1 0 0 NMOS W=1.8u L=1.2u
R1 in n1 55
VDD VDD 0 2.5
VIN in 0 2.5
```

---

# L3: Define Technology Parameters

## Model Definition for NMOS

<p align="center">
  <img width="310" height="273" alt="image" src="https://github.com/user-attachments/assets/885d43d5-2e31-468a-8c60-fb0bd69ee8f0" />
</p>

We have already defined the SPICE netlist.  
The next step is to define the model for this NMOS.

A model describes how a device behaves.

For example:

- AND gate → output is Boolean multiplication of inputs  
- OR gate → output is Boolean addition of inputs  

Similarly, NMOS has its own models.

When we plug in the model for this NMOS, the SPICE engine understands:

- Where NMOS is picked from  
- What constants must be used  
- How to evaluate threshold voltage  
- How to evaluate drain current equations  

All model parameters come as a package.


## Important Model Parameters

We previously introduced model parameters such as:

- VTO → Needed for threshold voltage  
- Gamma → Body effect coefficient  
- k'n  
- Lambda  
- Cox  
- Epsilon values  

Once these constants are provided, it becomes easy for the engine to calculate:

- VT  
- ID (linear region)  
- ID (saturation region)

These values are used during simulation.


## .MODEL Statement

The model is defined using:

```spice
.model NMOS nmos (parameters)
```


## Important Rule

The name **NMOS** in the model file must match exactly with the name used in the netlist.

If the names do not match, simulation will not work correctly.

This is a very important step.

Similarly, if PMOS is used in the circuit, the PMOS name must match its model definition.


## Example Model Parameters

Some parameter mappings:

- VTH0 → Threshold voltage without body bias  
- TOX → Oxide thickness  
- U0 → Mobility  
- Gamma1 → Body effect coefficient  

Example format:

```spice
.model NMOS nmos
+ TOX = value
+ VTH0 = value
+ U0 = value
+ GAMMA1 = value
```

Once these are defined:

The engine automatically substitutes:

- Gamma value into VT equation  
- Mobility into current equation  
- TOX into Cox calculation  

The engine evaluates all equations internally.

Provided correct inputs are given.


## Model Files for Technology Node

<p align="center">
<img width="323" height="145" alt="image" src="https://github.com/user-attachments/assets/2da7ca09-bd26-4db7-93fd-2355a768afde" /> </p>

For each technology node:

- 1.2 micron  
- 350 nanometer  
- Lower nodes  

Foundry provides all constants.

You package all model parameters into a single file.

Example section:

```spice
.lib CMOS_models
...
.endl CMOS_models
```

This defines a library block.

The list inside a real technology file is very large.

Only required parameters are used for our purpose here.


## Including Model File in Netlist

<p align="center">
<img width="317" height="252" alt="image" src="https://github.com/user-attachments/assets/9483a948-b5f2-4ac1-9401-d574498bd264" /> </p>

To use the model file in the top-level netlist:

```spice
.lib filename.mod CMOS_models
```

- `filename.mod` → Model file  
- `CMOS_models` → Section name inside file  

After inclusion:

- NMOS model parameters are loaded  
- Equations are evaluated  
- VT and ID models are active  


## Complete SPICE Deck Structure

We now have three sections:

### 1. Netlist Description

```spice
M1 VDD n1 0 0 NMOS W=1.8u L=1.2u
R1 in n1 55
VDD VDD 0 2.5
VIN in 0 2.5
```

### 2. Model File Inclusion

```spice
.lib filename.mod CMOS_models
```

### 3. Simulation Commands

Simulation commands are used to sweep voltages.

Previously, we calculated drain current for a single VGS.

But to evaluate:

- ID for multiple VGS values  
- While sweeping VDS from 0 to supply voltage  

We use SPICE simulation commands.

These commands allow:

- Sweeping VGS  
- Sweeping VDS  

This replaces manual hand calculation.

---


# L4 First SPICE simulation

## 1️. Clone Repository

```bash
git clone https://github.com/kunalg123/sky130CircuitDesignWorkshop
cd sky130CircuitDesignWorkshop/design
ls
```


## 2️. Go to Device Models

```bash
cd sky130
cd antiphase
cd cells
```

Use:

- `nfet_01v8`

Only use **W/L values provided inside the model corner files**.


## 3️. Select Corner

Open library file:

```bash
less sky130.lib.spice
```

Corners available:

- TT → Typical  
- SS → Slow-Slow  
- FF → Fast-Fast  
- SF → Slow-Fast  

Modify `.lib` line to change corner.


## 4️. Transistor Format

SPICE syntax:

```
M1 Drain Gate Source Bulk nfet_01v8 W=1.68 L=0.15
```

Source = 0  
Bulk = 0  
Supply = 1.8V  


## 5️. DC Sweep

Sweep:

- VDS → 0 to 1.8V (step 0.1V)
- VGS → 0 to 1.8V (step 0.2V)

```spice
.dc VDS 0 1.8 0.1 VGS 0 1.8 0.2
```


## 6️. Run Simulation

Inside NGSpice:

```bash
plot -i(VDS)
```


## Result

<p align="center"> <img width="493" height="502" alt="image" src="https://github.com/user-attachments/assets/4b894ab8-9b01-43bd-b5ce-49ed9a7d5f7c" />
</p>

- ID vs VDS curves generated  
- Low VDS → Linear region  
- High VDS → Saturation (quadratic behavior)  

---

# SL5 SPICE Lab with sky130 models

## 1️. Clone and Navigate

```bash
cd
git clone https://github.com/kunalg123/sky130CircuitDesignWorkshop
cd sky130_circuit_design_workshop
cd sky130
cd cells
cd nfet_01v8
```

## 2️. Open Library File

```bash
less sky130.lib.spice
```

Use **TT (Typical corner)**.

## 3️. Transistor Parameters

- Model: `nfet_01v8`
- W = **5 µm**
- L = **2 µm**
- Supply Voltage = **1.8 V**
- Source = 0
- Bulk = 0

## 4️. DC Sweep Settings

- VDS: 0 → 1.8 V (step 0.1 V)
- VGS: 0 → 1.8 V (step 0.2 V)


## 5️. Run Simulation

Inside NGSpice:

```bash
plot -VDD#branch
```

## 6️. Results

<p align="center"> <img width="493" height="318" alt="image" src="https://github.com/user-attachments/assets/56efd682-2a6b-472c-926f-1602bf6c2ac4" />
</p>
  
- ID vs VDS curves generated  
- Cutoff below **Vth ≈ 0.55 V**  
- Small current at VGS = 0.6 V (~2 µA)  

---

# Day 2:
---
# L1 SPICE simulation for lower nodes

## SPICE Simulation Results

In the previous simulation:

- Y-axis → Drain Current (ID)  
- X-axis → Drain-to-Source Voltage (VDS)

Multiple curves correspond to different values of VGS.


## Understanding the Curves

<p align="center">
  <img width="587" height="337" alt="image" src="https://github.com/user-attachments/assets/0c5b4a7a-549b-4ce7-91fa-38107724f6c4" />
</p>

### VGS = 0 V

- Curve overlaps the X-axis.
- Drain current = 0.
- Reason: Device is OFF.
- No channel formed.


### VGS ≈ Threshold

A curve slightly above zero current:

- VGS just crosses threshold voltage.
- Minimum channel is formed.
- Small drain current appears.


### Higher VGS Values

Curves correspond to:

- VGS = 1 V  
- VGS = 1.5 V  
- VGS = 2 V  
- VGS = 2.5 V  

All previously derived equations are encapsulated in these curves.

Each curve represents ID vs VDS for a specific VGS.


## Regions of Operation

<p align="center">
 <img width="546" height="308" alt="image" src="https://github.com/user-attachments/assets/8f156429-8598-45d3-9de7-b80534748e7d" />
</p>

The curve has two behavioral regions:

### 1️. Linear (Resistive) Region

- Drain current increases linearly with VDS.
- Occurs at low VDS.
- Derived equation:

```
ID = kn [(VGS − VT)VDS − VDS²/2]
```

At small VDS:

```
VDS²/2 → negligible
```

So:

```
ID ≈ kn (VGS − VT)VDS
```

Drain current is linear in VDS.


### 2️. Saturation Region

Condition:

```
VDS ≥ (VGS − VT)
```

At this point:

- Replace VDS with (VGS − VT)
- Drain current becomes:

```
ID = (kn/2)(VGS − VT)² (1 + λVDS)
```

- Not perfectly constant.
- Slight increase due to channel length modulation.
- Appears almost constant.


### 3️. Cutoff Region

Condition:

```
VGS ≤ VT
```

- No channel formed.
- Device OFF.
- ID = 0.


## Moving to Lower Node

Now consider new device dimensions:

- W = 0.375 µm  
- L = 0.25 µm  

W/L ratio is kept constant.

Expectation:

If W/L is constant → Drain current should remain same.

But this does **not** happen at lower nodes.


## New SPICE Simulation Setup

Only change from previous deck:

- W changed to 0.375 µm
- L changed to 0.25 µm
- All other parameters remain same:
  - Resistance
  - VDD
  - VIN
  - .op
  - .dc
  - Model file


## Running New Simulation

1. Source the new circuit file (.cir)
2. Run simulation:

```
run
```

3. Check available plots:

```
setplot
```

Select:

```
dc1
```

4. Display available nodes:

```
display
```

5. Plot drain current:

```
plot -VDD#branch
```

(negative sign due to current direction convention)


## New Plot Observations

Observations compared to previous case:

### 1️. Reduced Difference Between Curves

Spacing between adjacent VGS curves is reduced.


### 2️. Saturation Current Changed

Current in saturation region is different from previous long-channel case.


### 3️. Curve Spacing Behavior Changed

Difference between adjacent curves appears more uniform compared to earlier case.


## Comparison: Long Channel vs Short Channel

<p align="center">
  <img width="697" height="296" alt="image" src="https://github.com/user-attachments/assets/62f0443f-ebbd-41de-a45e-46201785ddcc" />
</p>

Previous device:

- W = 1.8 µm  
- L = 1.2 µm  

New device:

- W = 0.375 µm  
- L = 0.25 µm  

Even though W/L ratio is constant:

- Drain current is not identical.
- Behavior changes at lower technology nodes.


## Conclusion

Maintaining constant W/L does **not** guarantee same drain current at lower nodes.

Short-channel effects alter device behavior.

---


# L2: Drain Current vs Gate Voltage – Long and Short Channel Device

## Previous Simulation Context

In the previous SPICE simulation, two devices were analyzed:

- **Long channel device** → 1.2 µm  
- **Short channel device** → 0.25 µm  

We now focus on:

> Drain Current (ID) vs Gate Voltage (VGS)  
> At constant Drain Voltage (VDS)

## Observation for Long Channel Device (1.2 µm)

<p align="center">
  <img width="685" height="295" alt="image" src="https://github.com/user-attachments/assets/f2c8c513-bf7c-4469-918a-86484babfce0" />
</p>

Let:

- VDS = 2.5 V (constant)

Observations:

- At VGS = 0 → ID = 0  
- At VGS = 0.5 V → small ID (~10 µA)  
- At VGS = 1 V → larger ID (~40 µA)  

ID does **not** increase linearly with VGS.

It shows **quadratic dependence**.

This matches the derived equation:

```
ID = (kn/2) (VGS − VT)²
```

So:

- ID ∝ (VGS − VT)²  
- Drain current increases quadratically with gate voltage.

---

## Observation for Short Channel Device (0.25 µm)

<p align="center">
  <img width="691" height="287" alt="image" src="https://github.com/user-attachments/assets/15b8ab6d-26aa-4f71-8225-440ecfe95716" />
</p>

Initial region:

- At VGS = 0 → ID = 0  
- At VGS = 0.5 V → small ID  
- At VGS = 1 V → larger ID  

Here also, initially:

- ID shows quadratic dependence.

But after a certain VGS:

- ID increases **linearly** with VGS.

This behavior is different from long channel device.

---

## Key Difference

<p align="center">
<img width="698" height="318" alt="image" src="https://github.com/user-attachments/assets/235dbec3-c3de-4fd4-8a90-4eb3fee6491e" /> </p>

| Device Type | Behavior |
|-------------|----------|
| Long Channel (1.2 µm) | Quadratic throughout |
| Short Channel (0.25 µm) | Quadratic initially → Linear at higher VGS |

This effect is due to:

> **Velocity Saturation**

(Explanation continues later.)


# SPICE Simulation Setup – ID vs VGS

We now perform:

- ID vs VGS
- At constant VDS = 2.5 V


## SPICE Deck Change

Only one line changes:
New sweep condition:

- Sweep VGS from 0 → 2.5 V  
- Step = 0.1 V  
- VDS held constant at 2.5 V  

Syntax meaning:

- Left-hand variable is swept
- Right-hand variable defines outer sweep

# Direct Comparison

<p align="center">
  <img src="IMAGE_COMPARISON_ID_VGS" width="700">
</p>

Comparison:

- Long channel → Fully quadratic
- Short channel → Becomes linear at high VGS

# Conclusion

For constant VDS:

- Long channel device follows quadratic model.
- Short channel device deviates due to velocity saturation.
- This is a short channel effect observed at lower nodes.

Further analysis continues next.

---



