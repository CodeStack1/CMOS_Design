# Day 1:

---

# L1 Why do we need SPICE simulations?

## Overview

This lecture introduces the fundamental connection between circuit design and SPICE simulations in VLSI. Circuit design focuses on how logic gates such as inverters, NAND, NOR, AND, etc., are physically implemented using specific arrangements of PMOS and NMOS transistors. For example, in a CMOS inverter, the PMOS is connected at the top to VDD and the NMOS at the bottom to VSS, with their gates tied together and drains connected to form the output. This specific configuration gives the inverter its logic functionality. However, designing the connection alone is not sufficient; we must also understand how the circuit behaves electrically, which is where SPICE simulations become essential. SPICE characterizes transistor behavior by modeling NMOS and PMOS I-V characteristics and generating output waveforms. These waveforms determine delay, and delay depends directly on transistor sizing (W/L ratio), since W/L controls drive current, which shapes the output transition and ultimately defines cell timing.

<p align="center">
  <img src="https://github.com/user-attachments/assets/1bc14eb2-9c7f-46fe-9df8-06d16fb0c258" />
</p>


The lecture then explains why SPICE is critical in real VLSI flows such as physical design, clock tree synthesis (CTS), timing closure, and static timing analysis (STA). Although SPICE is not directly visible in these flows, all timing values used in STA originate from SPICE-based characterization. Standard cell libraries contain delay tables indexed by input slew and output load capacitance. For different buffer types (e.g., CBUF1 vs CBUF2), delay tables differ because their transistor sizes (W/L ratios) differ, giving them different drive strengths. When performing timing analysis, the tool selects a delay by interpolating between table entries based on the actual input slew and load capacitance. However, these delay values are not arbitrary; they are generated by detailed SPICE characterization of each cell under multiple conditions. Therefore, SPICE forms the foundation of all delay modelling.

## Example

In the example discussed, the instructor explains that different buffer types (such as CBUF1 and CBUF2) have different delay behaviours because they are designed with different transistor sizes (different W/L ratios), resulting in different drive strengths. The delay of a buffer is not a fixed value; instead, it depends on two main parameters: input slew and output load capacitance. Input slew refers to how fast the input signal transitions, and output load refers to the total capacitance the buffer must drive, including fanout and wiring capacitance. These two parameters form a delay table, where rows represent input slew values and columns represent output load values. The intersection gives the delay for that specific condition. If the exact load or slew is not available in the table, interpolation is used to estimate the delay. Even if two buffers receive the same input slew and drive the same load, their delays can differ because their internal transistor sizing differs. The instructor emphasizes that these delay values are not arbitrary; they come from SPICE characterization of each cell under different slew and load conditions. Thus, SPICE simulations are the foundation for generating the delay tables used in timing analysis, and they ensure that the delay values used in static timing analysis accurately reflect real transistor-level behaviour.

<p align="center">
<img width="708" height="366" alt="image" src="https://github.com/user-attachments/assets/b3b673f2-4e89-4319-9881-299c2bfaf6af" />
<img width="655" height="367" alt="image" src="https://github.com/user-attachments/assets/6381f3df-e82b-4b95-92cc-0a1285a12dc8" />
</p>

## Conclusion

The lecture raises three critical questions: (1) Where do delay tables come from? — They come from SPICE characterization of transistor-level circuits. (2) Are these delay models accurate? — Accuracy must be verified by comparing STA-extracted delays with direct SPICE simulation results under identical conditions. (3) How do we trust STA results? — By validating that the characterization data (derived from SPICE) accurately reflects real transistor behaviour. Ultimately, understanding NMOS and PMOS device physics, their voltage-current characteristics, and how W/L sizing affects delay is necessary to understand the origin of timing libraries and ensure correct chip functionality before tape-out. The lecture concludes by transitioning to a detailed study of NMOS transistor characteristics as the foundation for SPICE-based delay modelling. <br>

***


# L2 Introduction to basic element in Circuit design – NMOS

This lecture explains the fundamental structure of an NMOS transistor and builds the foundation for understanding threshold voltage and SPICE modeling. An NMOS is a four-terminal device consisting of gate, source, drain, and body (or bulk). It is built on a p-type substrate, and the source and drain are formed using heavily doped n+ diffusion regions. Above the substrate lies a thin gate oxide layer, and on top of the oxide is a polysilicon or metal gate. Isolation regions are also present to electrically separate adjacent transistors so that the operation of one device does not affect another. While the body terminal is often not explicitly shown in simplified circuit symbols because it is usually grounded, it plays a very important role in determining the threshold voltage. Any potential applied to the body can modify the threshold voltage, which directly affects device behavior.

<p align="center">
<img width="602" height="268" alt="image" src="https://github.com/user-attachments/assets/9737419d-99b7-4b90-9b57-6fa56ab35e66" /> </p>

The PMOS transistor has a similar structure but is complementary to the NMOS. It is built on an n-type substrate with p+ source and drain regions. Apart from the doping differences, the general structure remains the same. Understanding this structural difference is important for CMOS design.

##
The most critical parameter governing transistor operation is the threshold voltage (Vₜ). Threshold voltage determines when a conducting channel forms between source and drain. In SPICE simulations, transistor behavior is represented through mathematical models, and threshold voltage is a key component of these models. Although the full SPICE model contains complex equations, conceptually threshold voltage can be viewed as a function of several physical and electrical parameters. Accurate modeling of Vₜ ensures that SPICE simulations correctly represent real transistor behavior.

<p align="center">
<img width="677" height="257" alt="image" src="https://github.com/user-attachments/assets/cee5ef2e-fb4b-4312-92d4-139f2e76d419" /> </p>

To understand threshold voltage formation, consider the case when the gate-to-source voltage (VGS) is zero and all terminals are grounded. In this condition, the NMOS contains two back-to-back PN junctions: one between source and body and another between drain and body. Since no bias is applied, both junctions are effectively off, resulting in very high resistance between source and drain. No conducting channel exists, and therefore no current flows. The transistor is in the OFF state.

##

When a small positive voltage is applied to the gate, the gate, oxide, and substrate form a capacitor structure. The gate acts as one plate, the substrate acts as the other plate, and the oxide serves as the dielectric. Applying a positive voltage charges the gate positively. Because the substrate is p-type and contains holes as majority carriers, the positive gate voltage repels these holes away from the surface region beneath the gate. As holes move deeper into the substrate, they leave behind negatively charged ions. This creates a depletion region under the gate. At this stage, although charge redistribution has begun, a conducting channel has not yet formed.

<p align="center">
<img width="672" height="258" alt="image" src="https://github.com/user-attachments/assets/cb5fb083-3d40-4d8d-9720-d09797cf7102" /> </p>

If the gate voltage is increased further, the depletion region widens, and more holes are pushed away. Eventually, the electric field becomes strong enough to attract electrons (minority carriers in the p-type substrate) toward the surface. When sufficient electrons accumulate, an inversion layer forms beneath the gate oxide. This inversion layer creates a continuous conducting path between the n+ source and n+ drain regions. The gate voltage at which this conducting channel is formed is defined as the threshold voltage. Once VGS exceeds Vₜ, the transistor turns ON and current can flow between source and drain.

Understanding this physical process is essential because SPICE models are built upon these device physics principles. The threshold voltage, channel formation mechanism, and charge behavior directly influence I–V characteristics, delay, and overall transistor performance. Since all timing libraries and delay models used in digital design ultimately originate from SPICE-based characterization, a strong understanding of NMOS structure and threshold voltage formation is fundamental to accurate circuit design and timing analysis.

***

# L3: Strong Inversion and Threshold Voltage

## 1️. Initial Condition – VGS = 0 (Cutoff Region)

<p align="center">
  <img width="1292" height="488" alt="image" src="https://github.com/user-attachments/assets/311990e5-b4a9-4071-ade6-ed13e3b31c2e" />
</p>

When **VGS = 0** and drain, source, and bulk are connected to ground, the source–body and drain–body form two PN junction diodes. Since no bias is applied, both junctions are OFF.  

Therefore, the **source-to-drain resistance is very high**, and no current flows.  
The MOSFET operates in the **cutoff region**.

## 2️. Formation of Depletion Region

<p align="center">
  <img width="1282" height="481" alt="image" src="https://github.com/user-attachments/assets/ad2085f2-e233-4db5-ae60-4cf4c7466d30" />
</p>

When a small positive **VGS** is applied, the gate becomes positively charged.  
This repels holes (majority carriers in the p-substrate) away from the surface.  

As holes move deeper into the substrate, negative charge remains near the surface, forming a **depletion region**, similar to a reverse-biased PN junction diode.

## 3️. Increasing Gate Voltage – Surface Inversion Begins

<p align="center">
 <img width="830" height="483" alt="image" src="https://github.com/user-attachments/assets/920012a3-1082-41f8-a5da-f3de455427dc" />
</p>

As **VGS** increases further, the depletion region widens.  

Eventually, the electric field becomes strong enough to attract electrons (minority carriers) toward the surface.  
The semiconductor surface begins to behave like **n-type material**.

## 4️. Strong Inversion and Threshold Voltage (Vₜ)

<p align="center">
  <img width="1281" height="482" alt="image" src="https://github.com/user-attachments/assets/ba7f0a44-4e81-4218-9a80-5adafa64dae2" />
</p>

When the surface is fully inverted and a thin n-type layer forms beneath the gate oxide, the device reaches **strong inversion**.  

The gate voltage at which strong inversion occurs is defined as the:

> ### **Threshold Voltage (Vₜ)**

This voltage determines when the MOSFET turns ON and forms the foundation of SPICE modeling.

## 5️. Increasing VGS Beyond Threshold

<p align="center">
  <img width="1281" height="471" alt="image" src="https://github.com/user-attachments/assets/a7cba5be-0e80-45c0-bc50-1cf6649a08d4" />
</p>

After threshold is reached:

- The depletion width does **not increase significantly**
- The region is already depleted of majority carriers
- Additional gate voltage increases **inversion charge density**

## 6️. Electron Attraction from n+ Source

<p align="center">
  <img width="598" height="470" alt="image" src="https://github.com/user-attachments/assets/4fc44052-0988-4904-93b7-ad0df55ad515" />
</p>

When VGS increases beyond Vₜ, electrons are drawn from the heavily doped **n+ source region** into the area under the gate.  

This strengthens the inversion layer and increases channel charge.

## 7️. Continuous n-Channel Formation

<p align="center">
 <img width="1297" height="605" alt="image" src="https://github.com/user-attachments/assets/92d4c137-1887-44f1-a4bd-afc199624af8" />
</p>

Once sufficient electrons accumulate, a **continuous n-type channel** forms between source and drain.  

The conductivity of this channel is controlled by **VGS**.  

Current will flow only when a drain voltage is applied.

## 8️. Case 1: VSB = 0

<p align="center">
  <img width="536" height="477" alt="image" src="https://github.com/user-attachments/assets/269a4ba3-0b9c-44c6-8493-1604815f415f" />
</p>

When source and body are at the same potential:

- No additional reverse bias exists
- Depletion width is normal
- Threshold voltage is at nominal value

## Case 2: VSB > 0

<p align="center">
 <img width="647" height="453" alt="image" src="https://github.com/user-attachments/assets/a2dcf7a2-fc18-4d3c-ae0b-76f94e3353a9" />
</p>

When a positive voltage is applied between source and body:

- The source–body PN junction becomes more reverse biased
- Depletion region width increases near the source

## 9. Additional Reverse Bias Effect

<p align="center">
  <img width="1175" height="542" alt="image" src="https://github.com/user-attachments/assets/dd2a5b07-beef-4a4e-afa0-20d30efb2eb0" />
</p>

The additional reverse bias makes inversion harder to achieve because:

- A larger depletion region must be overcome
- More gate voltage is required


## 10. Depletion Width Increases Near Source

<p align="center">
 <img width="1212" height="582" alt="image" src="https://github.com/user-attachments/assets/098eff6e-9fdb-4bb6-952d-2e4db412f7a3" />
</p>

The depletion layer near the source becomes slightly larger compared to the VSB = 0 case.  

Therefore, inversion is delayed.

***

# L4: Threshold Voltage in Presence of Body Bias (VSB ≠ 0)

## 1️. Comparing Two Cases: VSB = 0 and VSB > 0

<p align="center">
  <img width="680" height="321" alt="image" src="https://github.com/user-attachments/assets/569f37d4-d52a-45a0-892c-71f21319728c" />
</p>

We consider two scenarios:

- Case 1: VSB = 0  
- Case 2: VSB > 0  

In both cases, the gate-to-source voltage (VGS) is increased gradually.  
The depletion width increases in both scenarios.  

However, a key difference appears when VSB is positive.


## 2️. Effect of Positive VSB on Charge Distribution

<p align="center">
 <img width="613" height="262" alt="image" src="https://github.com/user-attachments/assets/ed4638e0-6360-414a-8a8b-82b4b9ee0dd8" />
</p>

When VSB is positive, the source is at a higher potential relative to the body.  
This creates additional reverse bias across the source–body PN junction.

As negative charges accumulate under the gate due to increasing VGS,  
the positive source terminal attracts some of these charges toward itself.

In the VSB = 0 case, charges simply accumulate under the gate region.

This causes inversion to be delayed when VSB > 0.


## 3️. Surface Inversion Comparison

<p align="center">
  <img width="627" height="257" alt="image" src="https://github.com/user-attachments/assets/449ad035-648f-416d-a07e-a0a974fe297e" />
</p>

As VGS increases:

- Inversion occurs earlier when VSB = 0  
- Inversion is delayed when VSB > 0  

At the same VGS value, the device without body bias may already show strong inversion,  
while the device with positive VSB has not yet fully inverted.


## 4️. Definition of VTO (Threshold Voltage at VSB = 0)

<p align="center">
  <img width="647" height="317" alt="image" src="https://github.com/user-attachments/assets/343099b0-b525-4660-9fa8-cca860d2b8ac" />
</p>

**VTO** is defined as the threshold voltage when VSB = 0.

At:

- VGS = VTO → Strong inversion occurs when VSB = 0  
- The same VGS does not produce inversion when VSB > 0
- 

## 5️. Additional Gate Voltage Required (VTO + V1)

<p align="center">
<img width="680" height="316" alt="image" src="https://github.com/user-attachments/assets/cdda03c0-90f7-4f45-b576-6f0fd469d4a1" />
</p>

When VSB is positive, additional gate voltage is required to achieve inversion.

If:

- VGS = VTO → inversion only when VSB = 0  
- VGS = VTO + V1 → inversion when VSB > 0  

An extra voltage **V1** is required due to body bias.


## 6️. Conclusion: 

<p align="center">
  <img width="680" height="364" alt="image" src="https://github.com/user-attachments/assets/3149b3e0-bc04-4dfb-9794-8ec8f973b1db" />
</p>

In the presence of substrate bias VSB:

- Strong inversion requires additional gate voltage  
- Threshold voltage increases  


## 7️. Threshold Voltage Equation

<p align="center">
  <img width="678" height="302" alt="image" src="https://github.com/user-attachments/assets/563a39cd-6dd7-4601-9871-d919c2db2767" />
</p>
- Vto = Threshold voltage at Vsb = 0, and is a function of manufacturing process.


## 8. Body Effect Coefficient (γ)

<p align="center">
  <img width="222" height="117" alt="image" src="https://github.com/user-attachments/assets/8eae9769-4617-4d54-bc37-7f1b6b0a9dd3" />
      </p>

γ (Gamma) is called the **Body Effect Coefficient**.

It represents how strongly VSB influences the threshold voltage.

Gamma depends on:

- Substrate doping concentration (NA)  
- Oxide capacitance (Cox)  
- Relative permittivity of Si = 11.7
- Electron charge (q)   

These parameters are technology-dependent and provided by the foundry.


## 9. Fermi Potential (ΦF)

<p align="center">
  <img width="270" height="76" alt="image" src="https://github.com/user-attachments/assets/f0fa453f-9270-48ee-86ba-a3c1f31e56db" />
</p>

The Fermi potential (ΦF) appears in the threshold voltage equation.

---

# L5: Resistive (Linear) Region of Operation


## 1️. Three Modes of Operation

<p align="center">
 <img width="652" height="247" alt="image" src="https://github.com/user-attachments/assets/61555aa1-95e0-4e67-8621-2d1d447da8ec" />
</p>

The MOSFET operates in three regions:

- Cutoff region  
- Resistive (Linear) region  
- Saturation region  

Previous discussions focused on the cutoff region, where strong inversion occurs at VGS = VT.  
This section begins the discussion of the resistive (linear) region.


## 2️. Threshold Voltage Recap

<p align="center">
<img width="670" height="261" alt="image" src="https://github.com/user-attachments/assets/c98efddf-f63f-4f7a-810e-c126b0e9ea4a" />
</p>

At VGS = VT, strong inversion occurs and the semiconductor surface becomes n-type.  

When VGS > VT:

- More charge carriers are induced  
- Channel width increases  
- Conducting path between source and drain strengthens  


## 3️. Effective Channel Length

<p align="center">
  <img width="403" height="321" alt="image" src="https://github.com/user-attachments/assets/005be098-892a-45b3-819b-0030fd7e0eb1" />
</p>

Due to fabrication techniques, the effective channel length is smaller than the designed channel length.

For example:

- Designed channel length may be 100 nm  
- Effective channel length may be smaller  

For simplicity in this discussion, the effective channel length is assumed to be L.


## 4️. Channel Representation Along x-Axis

<p align="center">
  <img width="662" height="303" alt="image" src="https://github.com/user-attachments/assets/04f4f7b6-e02c-4daa-affd-85f79036641f" />
</p>

The channel is represented from:

- x = 0 (source)  
- x = L (drain)  

At every point along the channel, the voltage can be different once VDS is applied.


## 5️. Induced Charge and Gate Voltage Relationship

As VGS increases:

- Channel width increases  
- Induced charge increases  
- Conducting region expands  

The induced charge in the channel is proportional to:

VGS − VT  

Only the portion of VGS greater than VT contributes to channel formation.


## 6️. Applying Small Drain-to-Source Voltage (VDS)

<p align="center">
  <img width="422" height="318" alt="image" src="https://github.com/user-attachments/assets/917eefc4-388d-4853-b1e1-a1cc607a4fba" />
</p>

Now a small drain-to-source voltage is applied.

Example values used:

- VGS = 1 V  
- VDS = 0.05 V (50 mV)  

VDS is kept very small initially.  
Higher VDS cases will be discussed later.


## 7️. Voltage is No Longer Constant Across the Channel

<p align="center">
  <img width="422" height="318" alt="image" src="https://github.com/user-attachments/assets/4c697de7-1a51-4dc5-9620-610d6baedc49" />
</p>

In the absence of VDS, the channel voltage is constant.

Once VDS is applied:

- A voltage gradient appears  
- Voltage varies along the channel  

At different positions:

- At source end → V(x) ≈ 0  
- At drain end → V(x) ≈ VDS  
- Intermediate points → Voltage lies between 0 and VDS  

This is an important observation.


## 8️. Gate-to-Channel Voltage Variation

<p align="center">
  <img width="421" height="330" alt="image" src="https://github.com/user-attachments/assets/534aca29-ebf4-463f-a657-c79f11b67d24" />
</p>

With VDS applied, the effective gate-to-channel voltage at any point x becomes:

VGS − V(x)

Because:

- V(x) = 0 at source  
- V(x) = VDS at drain  
- V(x) varies continuously along channel  

Therefore, channel charge varies along the channel length.


## 9️. Condition on VDS

Two different behaviors are mentioned:

- When VDS < VGS − VT  
- When VDS > VGS − VT  

These two cases behave differently and will be discussed later.

For now, VDS is assumed to be small.


## 10. Transition to Drain Current Derivation

Because V(x) varies across the channel:

- Induced charge varies  
- Current will vary along the channel  

The drain current equation will be derived next.

The drain current equation:

- Drives transistor behavior  
- Determines delay  
- Is used in simulations and circuit design  

The derivation in the resistive region will continue in the next discussion.

---

